<!doctype html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font: 13px Helvetica, Arial; }
      form { background: #000; padding: 3px; position: fixed; bottom: 0; width: 100%; }
      form input { border: 0; padding: 10px; width: 90%; margin-right: .5%; }
      form button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 10px; }
      #messages { list-style-type: none; margin: 0; padding: 0; }
      #messages li { padding: 5px 10px; }
      #messages li:nth-child(odd) { background: #eee; }
      table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
      }
      th, td {
        padding: 15px;
      }

      .btn:hover {
        background: #2079b0;
        background-image: -webkit-linear-gradient(top, #2079b0, #eb94d0);
        background-image: -moz-linear-gradient(top, #2079b0, #eb94d0);
        background-image: -ms-linear-gradient(top, #2079b0, #eb94d0);
        background-image: -o-linear-gradient(top, #2079b0, #eb94d0);
        background-image: linear-gradient(to bottom, #2079b0, #eb94d0);
        text-decoration: none;
        cursor: pointer;
      }
    </style>
  </head>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
  <script>
    let divElement = function(){
        divCode = document.getElementById(div1).innerHTML;
        return divCode; };

        function newGames() {
          let socket = io();
          socket.emit('chat message', 'NEWGAME');
        }
        function newNumbers() {
          let socket = io();
          socket.emit('chat message', 'NEWNUMBER');
        }

        $(function () {
          let socket = io();
          $('form').submit(function(e){
            e.preventDefault(); // prevents page reloading
            socket.emit('chat message', $('#m').val());
            $('#m').val('');
            return false;
          });
          
          socket.on('chat message', function(msg){
            if (msg.charAt(0) == "{" && msg.charAt(1) == '"') {
              mass = JSON.parse(msg);
              addBoardToScreen(mass);
            } else if (msg.charAt(0) == "N" && msg.charAt(1) == 'E' && msg.charAt(2) == 'W' && msg.charAt(8) == 'R') {
              let len = msg.length;
              let numberFromMsg = '';
              for (let p = 9; p < len; p++) {
                numberFromMsg += msg.charAt(p);         
              }
              points[points.length] = numberFromMsg;
              $("#allNumber").html(points + " ");
              // console.log(points);
            } else {
              $('#messages').append($('<li>').text(msg));
            }
            
          });
        });
      let points = [];
      let mass =  {'b': [0,0,0,0,0], 'i': [0,0,0,0,0], 'n': [0,0,"FREE",0,0], 'g': [0,0,0,0,0], 'o': [0,0,0,0,0]};
      let b = mass['b'];
      let i = mass['i'];
      let n = mass['n'];
      let g = mass['g'];
      let o = mass['o'];
      addBoardToScreen(mass);

      function addBoardToScreen (mass) {

        let b = mass['b'];
        let i = mass['i'];
        let n = mass['n'];
        let g = mass['g'];
        let o = mass['o'];
        
        for (let q = 0; q < 6; q++) {
        $(document).ready(function(){
          $("#b"+q).html(b[q]);
          $("#i"+q).html(i[q]);
          $("#n"+q).html(n[q]);
          $("#g"+q).html(g[q]);
          $("#o"+q).html(o[q]);
        });  
      }
      }     
        
  </script>
  <body>
    <div style="height: 250px; border-style: solid; ">
      <div style="height: 300px; width:300px; display:block; float:left;">
          <table style="width:300px;">
              <tr>
                <th id="b0"></th>
                <th id="i0"></th> 
                <th id="n0"></th>
                <th id="g0"></th> 
                <th id="o0"></th>
              </tr>
              <tr>
                <th id="b1"></th>
                <th id="i1"></th> 
                <th id="n1"></th>
                <th id="g1"></th> 
                <th id="o1"></th>
              </tr>
              <tr>
                <th id="b2"></th>
                <th id="i2"></th> 
                <th id="n2">FREE</th>
                <th id="g2"></th> 
                <th id="o2"></th>
              </tr>
              <tr>
                <th id="b3"></th>
                <th id="i3"></th> 
                <th id="n3"></th>
                <th id="g3"></th> 
                <th id="o3"></th>
              </tr>
              <tr>
                <th id="b4"></th>
                <th id="i4"></th> 
                <th id="n4"></th>
                <th id="g4"></th> 
                <th id="o4"></th>
              </tr>
          </table>
      </div>
      <div style="height: 300px; width:150px; display:block; float:left;">
          <button id="NewGame" class="btn" onclick='newGames()' style="  
          background-color: #4CAF50;
          border: none;
          color: white;
          padding: 15px 35px;
          text-align: center;
          text-decoration: none;
          display: inline-block;
          font-size: 16px;">New Game</button>
          <button id="NewNumber" class="btn" onclick='newNumbers()' style="  
          background-color: #008CBA;
          border: none;
          color: white;
          padding: 15px 35px;
          text-align: center;
          text-decoration: none;
          display: inline-block;
          font-size: 16px;">New number</button>
      </div>
      <div id="allNumber" style="font-size: 20px; word-break:break-all;">

      </div>


    </div>
    <h1>Write "BINGO" if all number in your card was called</h1>
    <ul id="messages"></ul>
    <form action="">
      <input id="m" autocomplete="off" /><button>Send</button>
    </form>
  </body>
</html>